AuthorID,Author,Date,Content,Attachments,Reactions
"323371864074485771","mole99","2025-08-27T13:19:12.5340000+00:00","","",""
"323371864074485771","mole99","2025-08-27T13:19:13.1800000+00:00","The trick (or problem) is that the DVDD/DVSS pins are all on Metal2, which means the PDN ring will only connect to the pads via Metal2. Metal2 is vertical by default, which means we can only have I/O power/ground cells in the northern or southern I/O row (in the current setup, I hope we can change this).","",""
"323371864074485771","mole99","2025-08-27T13:19:26.9350000+00:00","This example design now runs through the whole flow without any problems, except that netgen LVS fails since the power/ground pins are not yet properly represented in the PNL.","",""
"323371864074485771","mole99","2025-08-27T13:19:50.6890000+00:00","@tnt I think you looked into overriding the preferred directions in pdngen at some point? Did you manage to achieve this?","",""
"323371864074485771","mole99","2025-08-27T13:20:25.6120000+00:00","@htamas I noticed that you have some `CONNECT_POWER_PADS` defines in your code. Did you manage to get the PNL to properly connect the core PDN to the I/O power/ground bondpad pins?","",""
"323371864074485771","mole99","2025-08-27T13:20:46.8060000+00:00","I'm gonna upload this repo soon to the wafer.space GitHub with a WIP PDK so anyone can reproduce this with the LibreLane padring step.","",""
"596068704471482370","246tnt","2025-08-27T13:27:08.1580000+00:00","@mole99 No, I didn't manage to do it, it's pretty wired down everywhere ...   and in the end the IHP guys changed the direction in the tech LEF üòÖ","",""
"323371864074485771","mole99","2025-08-27T13:32:36.0400000+00:00","Well, that's one solution üòÑ

Actually, I think the `add_pdn_ring -connect_to_pads` function should be more flexible. If we have a core ring with Metal5 and Metal4, it should still be able to make all connections with Metal2 and then drop vias. Maybe this function just needs another argument to override this. I'll ask the folks at OpenROAD what they think about this.","",""
"323371864074485771","mole99","2025-08-30T17:23:52.5370000+00:00","I got the power/ground bondpads connected and LVS to match üëè","",""
"323371864074485771","mole99","2025-08-30T17:24:18.3950000+00:00","@htamas In your padring script, I saw that you used `place_io_terminals` to place the BTerms for the I/O pads, since the bondpads are integrated into the cells (as opposed to IHP):

```
place_io_terminals gf180mcu_fd_io__*/DVSS
place_io_terminals gf180mcu_fd_io__*/DVDD
```

It seems that `place_io_terminals` simply promotes the first pin of the specified port to a BTerm.","",""
"323371864074485771","mole99","2025-08-30T17:24:23.8600000+00:00","For the default power/ground pads that would be one of the pins on the side, resulting in this:","",""
"323371864074485771","mole99","2025-08-30T17:24:35.2710000+00:00","","https://cdn.discordapp.com/attachments/1410252190282678284/1411401227744313394/Bildschirmfoto_vom_2025-08-30_18-29-36.png?ex=691ab193&is=69196013&hm=fd3333fb440484ced92a1ce5fbc87c5b0e2032a923d7410cc733fbf5c5a2bc02&",""
"323371864074485771","mole99","2025-08-30T17:24:53.7000000+00:00","It turns out that the power/ground pads don't even have pins at the bondpad locations, so by default the `place_io_terminals` command cannot work as we want it to work.

Therefore, I tried to add a `PAD` port, just like the other I/O pads, which initially seemed to work fine: I could global-connect it to the respective VDD/VSS net. However, PSM would throw an error, because there is no physical connection between PAD and any of the power pins.

```
[18:32:56] ERROR    [PSM-0069] Check connectivity failed on VDD.
[18:33:07] ERROR    [PSM-0069] Check connectivity failed on VSS.
```","",""
"323371864074485771","mole99","2025-08-30T17:25:17.4250000+00:00","So instead I added another pin to the DVSS/DVDD ports that matches the location of the bondpads (same as PAD) and is listed as the first pin in the LEF file. This way `place_io_terminals` promotes the correct pin to a BTerm.

However, instead of:

```
place_io_terminals gf180mcu_fd_io__*/DVSS
place_io_terminals gf180mcu_fd_io__*/DVDD
```

We have to write:

```
place_io_terminals gf180mcu_fd_io__dvss*/DVSS
place_io_terminals gf180mcu_fd_io__dvdd*/DVDD
```

As otherwise we would still get one BTerm at the side of the power/ground pad.","",""
"323371864074485771","mole99","2025-08-30T17:25:30.7400000+00:00","With this change the PDN is complete:","",""
"323371864074485771","mole99","2025-08-30T17:25:37.6890000+00:00","","https://cdn.discordapp.com/attachments/1410252190282678284/1411401489288528052/Bildschirmfoto_vom_2025-08-30_19-00-07.png?ex=691ab1d1&is=69196051&hm=0f794cbee98dcb27992fb818546c0697ceae614d26668aafa43c3a0de2a96914&",""
"323371864074485771","mole99","2025-08-30T17:25:46.4970000+00:00","PSM is happy:

```
[INFO PSM-0040] All shapes on net VDD are connected.
[INFO PSM-0040] All shapes on net VSS are connected.
```

And netgen as well:

```
Final result:
Circuits match uniquely.
```","","üéâ (1)"
"323371864074485771","mole99","2025-08-30T17:26:19.5760000+00:00","I think that would be reasonable change in the PDK. What do you think @tnt @htamas @Tholin?","",""
"543162393413287956","h.tamas","2025-08-30T17:37:59.4150000+00:00","Sounds good to me, thanks for figuring it out.","","üëç (1)"
"323371864074485771","mole99","2025-08-30T17:40:16.3690000+00:00","Thanks, your script was really helpful!","",""
"596068704471482370","246tnt","2025-08-30T17:45:04.1520000+00:00","@mole99 ack.","",""
"220639106915368960","tholin","2025-08-30T17:48:39.5920000+00:00","Definitely a less scuffed solution than me giving the power/ground IO cells tails.","",""
"220639106915368960","tholin","2025-08-30T17:49:09.6570000+00:00","And tricking pdngen into thinking those tails are part of the PDN grid.","",""
"323371864074485771","mole99","2025-08-30T17:54:54.3870000+00:00","Sounds good then. I'll update the LEF view of `gf180mcu_fd_io__dvss` and `gf180mcu_fd_io__dvdd` to add the pin geometry.","","üëç (1)"
