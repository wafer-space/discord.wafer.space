==============================================================
Guild: wafer.space Community
Channel: üèóÔ∏è - Designing / project-template
==============================================================

[10/02/2025 16:40] mole99
üì¢ Major update to the [gf180mcu-project-template](https://github.com/wafer-space/gf180mcu-project-template)! 

The example design now runs through the complete flow, including:

- Sealring insertion
- Filler generation

... and is DRC and LVS clean, according to the open source PDK.

There is now also a [cocotb](https://www.cocotb.org/) testbench available in the repository. We use the newly released cocotb 2.0.0.
You can run RTL as well as GL simulations, after implementing the design.

To ensure your design will be accepted for tapeout, you will be able to run the [gf180mcu-precheck](https://github.com/wafer-space/gf180mcu-precheck).
At the moment it is still a work in progress.

Further updates will follow, but you can use the current state as a stable basis for implementing your design.
If you encounter any issues, please report them so that we can improve both the template and the PDK.

PS: Special thanks to @Tim Edwards for his help in solving the uncovered PDK and tool-related issues.

Leo

{Reactions}
üëç (2)

[10/02/2025 16:45] rtimothyedwards_19428
Tim Edwards has only barely begun to address all the issues that have surfaced over the past few weeks. . .


[10/02/2025 16:48] tholin
Its that bad?


[10/02/2025 16:48] mole99
Haha, I also have to upstream a number of LibreLane related patches üòÑ


[10/02/2025 16:51] mole99
Also I forgot to mention that it is now possible to adjust the padring directly from the LibreLane configuration file.


[10/02/2025 17:09] h.tamas
Started a thread.


[10/02/2025 18:04] rtimothyedwards_19428
@Tholin :  Well, it means there's a lot to do if we want people to have successful tapeouts.


[10/02/2025 18:10] tholin
Bad time for me to be designing analog layouts?


[10/02/2025 18:15] rtimothyedwards_19428
@Tholin :  Great time for you to be designing analog layouts!  That will help flush out a lot of issues.  Make sure that you spot-check designs against the documented rules occasionally and let me know about anything that looks wrong.  Feel free to post a layout to me if you want me to double-check it for issues.


[10/02/2025 18:16] mithro_
See what @Tim Edwards said! üôÇ


[10/02/2025 18:20] tholin
Alright, sounds good.


[10/02/2025 18:20] tholin
I'll keep going.


[10/04/2025 01:11] xintingjiang_36756
I'm curious what is the current problem of this template, is this made the nov gf180 mpw shuttle


[10/04/2025 01:23] mithro_
@Xinting Jiang - It should be usable but just keep it up to date as you go.

{Reactions}
üëç

[10/04/2025 07:35] mole99
Exactly. You can already get started with your design, just make sure to keep it up to date with the upstream template.

{Reactions}
üëç

[10/11/2025 03:01] asc9742
@mole99 Hi Leo, I am trying to replace all 56 user pads with analog pads (gf180mcu_fd_io_asig_5p0). Got this error "No shape in terminal analog[0\].pad/ASIG5V found on layer Metal5". Any ideas on this issue? Attached a screenshot + the yaml and system verilog files.

{Attachments}
project-template_media/image-B347D.png
project-template_media/config_sv_files-19959.zip


[10/11/2025 08:20] mole99
Hi @asc, there was a port missing for the bondpad BTerm in the `gf180mcu_fd_io__asig_5p0` cell.
If you update your PDK, it should run through now.

{Reactions}
üëç

[10/11/2025 16:52] asc9742
Thank you @mole99 Ran into a new problem with the global routing. I had exchanged all user pads with analog pads, including the clk and rst pad. Could that be causing an issue?

{Attachments}
project-template_media/image-6899C.png


[10/12/2025 05:21] mole99
Yes, that will be a problem. The SDC expects at least one clock. Can you share a repository with your current state? I will take a look tomorrow.


[10/13/2025 11:59] mole99
Started a thread.


[10/16/2025 13:48] mole99
The [precheck](https://github.com/wafer-space/gf180mcu-precheck) has been updated to finish cleanly with the example project.
The precheck is your gateway to fabrication and will need to be completed via the online platform (coming soon).
You can, of course, run it locally to more easily debug failures.

If you are working on a design, please give it a try and let us know how it goes (SRAMs should still throw errors, that's being worked on next).
Most importantly: please let us know if you can "cheat" your way through the precheck üòâ


[10/16/2025 14:07] tholin
@mole99 I just updated my project with the changes from the template and since one of the commits reads "Update LibreLane", I tried running LL on example_project again to see if the error during GLB is gone. Instead, it now fails even earlier during STA.


[10/16/2025 14:35] mole99
Started a thread.


[10/16/2025 20:46] jalf_47390
@mole99 Is there any ESD protection in the IO pins in the template or is it required to be added? If it is in there already, what did you include? Same for all pins differences between them?


[10/17/2025 04:56] mole99
Started a thread.


[10/20/2025 01:08] polyfractal
how much memory does the `make librelane` step need (roughly)? I fired up an old linux laptop to play around with everything and it crashed after eating 16gb RAM + 4gb swap üôÇ  Curious if I should just increase swap and let it run, or if it really needs like 32 or 64gb?


[10/20/2025 03:58] polyfractal
more swap did the trick üôÇ

{Reactions}
waferspace üëç

[10/20/2025 06:32] mole99
It depends on your design üòÅ
Yesterday, I implemented the example template on my laptop, which also has 16 GB of RAM, and it had to use swap as well.

The step that uses the most memory atm is most likely the filler generation.
There you can easily trade off memory consumption by changing the number of tiles (threads) and their size.
I will add some LibreLane configuration variables so that this can be easily tweaked directly from the config.
In the meantime, you can pass the `--jobs` argument to LibreLane to limit the global thread limit across all steps.

{Reactions}
üëç

[10/20/2025 07:40] mole99
Never mind, none of that will be necessary anymore üòÖ

I've just fixed an embarrassing bug in the filler generation script: https://github.com/wafer-space/gf180mcu/commit/57a5725eb4a722cb148ff8cf84c5f22ce0be8d64
Now, filler generation uses only a fraction of the memory and completes much faster.
Always double check how functions are supposed to be used (the naming actually said it all üòÑ).

{Embed}
https://github.com/wafer-space/gf180mcu/commit/57a5725eb4a722cb148ff8cf84c5f22ce0be8d64
bugfix!: specify the tile margin as just the tile margin without th...
‚Ä¶tile size

Signed-off-by: Leo Moser <leomoser99@gmail.com>
project-template_media/57a5725eb4a722cb148ff8cf84c5f22ce0be8d64-8D20B


[10/20/2025 07:42] mole99
üì¢ Please update your project templates and pull the latest changes from the PDK!


[10/20/2025 13:51] polyfractal
awesome, thanks @mole99!

{Reactions}
üëå

[10/20/2025 22:17] mattvenn
when will the submission system be open?

{Reactions}
üíú

[10/21/2025 06:22] mole99
That's for @Tim 'mithro' Ansell to say.


[10/21/2025 08:53] mithro_
@Matt Venn - Hopefully in the next week.


[10/26/2025 19:54] tholin
That's quite a lot of VDD and VSS pads on the template. Like 10 each. That seems a bit excessive. What is the max current per pad?


[10/27/2025 02:50] mithro_



[10/27/2025 02:51] mithro_
@Tholin - That was from @tnt in the #cob channel.


[10/27/2025 08:12] tholin
Ah, I see. Thank you.


[11/01/2025 19:17] tholin
Getting some *extreme* hold violations when integrating a macro into chip_top that is not present when hardening the macro itself. Checking the logs, the worst slack is simply from the reset pad.

{Attachments}
project-template_media/image-91CC9.png


[11/01/2025 19:21] markemer
Is that in ns? If so, oof. And could it be a bad capacitance extraction on the pads themselves?


[11/01/2025 19:28] 246tnt
That's probably because the macro has its own clock tree. So the clock that its internal FF sees is delayed by many ns compared to the clock on its input pin.


[11/01/2025 19:29] 246tnt
If the CTS inside your top level project isn't setup to feed the macro an "early clock" (i.e. from the root of its clock tree instead of a leaf), that could explain why you see so many hold violations.


[11/01/2025 19:30] 246tnt
(Just a theory of course ... can't do more than theorize without more data)


[11/01/2025 19:45] tholin


{Attachments}
project-template_media/image-226EA.png


[11/01/2025 19:45] tholin
I don't have a repo for this yet


[11/01/2025 19:46] tholin
There is no CTS in the top level


[11/01/2025 19:46] tholin
Actually, there is no standard cells in the top level


[11/01/2025 19:46] tholin
Just macros


[11/01/2025 20:56] tholin
I guess this calls for a custom SDC file. I started by copying the SDC file provided by efabless for user project macros and will progressively modify it.


[11/01/2025 22:33] tholin
Literally nothing I do is changing the hold violations. Its refusing to budge.


[11/02/2025 16:16] tholin
Almost got it. Commit soon. Just trying to clean up my SDC file.


[11/02/2025 16:17] tholin
What‚Äôs the point of `set_driving_cell`? Does it automatically determine slew rates and delays, or do I still need to specify those manually?


[11/02/2025 16:42] tholin
Doesn‚Äôt matter. I cannot `set_driving_cell -lib_cell gf180mcu_fd_io__bi_24t` inside my macro SDC files anyways:

{Attachments}
project-template_media/image-55734.png


[11/02/2025 18:10] mole99
Do you use the LibreLane version from the template or [this branch](https://github.com/librelane/librelane/pull/806)?
Otherwise the pad cells are not read in.


[11/02/2025 18:16] tholin
I cannot use the LibreLane version from the template for my macros. Python error.

{Attachments}
project-template_media/image-BC7E4.png


[11/02/2025 18:17] tholin
I mean, the PDK Version


[11/02/2025 18:18] tholin
The error during GPL I reported before persists, so I cannot use the LibreLane version.


[11/02/2025 18:21] tholin
But I also don‚Äôt understand what `set_driving_cell` even does. Right now my approach has been to determine values to set on `set_input_delay` , `set_clock_latency`, `set_input_transition` and `set_clock_transition` by manually interpreting the values in the liberty files for the IO pads.


[11/02/2025 18:21] tholin
Except when it comes to the internal bus inside the chip, where I have to rely on STA for numbers.


[11/02/2025 18:23] tholin
Actually, it seems fine now, at least on this one macro, but there is still a big difference in behavior.


[11/02/2025 18:24] tholin
I just got to `Stage 37 - Resizer Timing Optimizations (Post-Clock Tree Synthesis)` on this CPU macro and on Iteration 0 its starting with a TNS of **-5042** compared to main librelane, where I got -250.


[11/02/2025 18:24] tholin
I changed nothing about the config.


[11/02/2025 18:24] tholin
Just switched LL versions.


[11/02/2025 19:22] tholin
Yeah, I‚Äôm getting severe performance degradation in the wafer.space template LL version in two ways. The timings of the design are worse, and also the flows take forever to run. After one hour, it is still stuck in Timing Optimizations. This whole flow used to take < 15 minutes. @mole99


[11/03/2025 00:24] tholin
@mole99 This page linked in the README of the template no longer exists.

{Attachments}
project-template_media/image-C502E.png


[11/03/2025 00:24] tholin


{Attachments}
project-template_media/image-6E9A7.png


[11/03/2025 07:16] mole99
The wafer.space gf180mcu PDK requires the LibreLane version in the template (or from the branch).


[11/03/2025 07:17] mole99
The issue is still open at OpenROAD's side: https://github.com/The-OpenROAD-Project/OpenROAD/issues/8229
However, as mentioned before, you can simply disable timing driven placement.


[11/03/2025 07:18] mole99
`set_driving_cell` automates exactly that. It takes the values directly from the LIB.


[11/03/2025 07:19] mole99
Thanks for reminding me. The LibreLane docs have recently been updated.


[11/03/2025 08:12] tholin
Thank you. I could find 0 information about this command online.


[11/03/2025 08:23] 246tnt
https://github.com/The-OpenROAD-Project/OpenSTA/blob/master/doc/OpenSTA.pdf

{Embed}
https://github.com/The-OpenROAD-Project/OpenSTA/blob/master/doc/OpenSTA.pdf
OpenSTA/doc/OpenSTA.pdf at master ¬∑ The-OpenROAD-Project/OpenSTA
OpenSTA engine. Contribute to The-OpenROAD-Project/OpenSTA development by creating an account on GitHub.
project-template_media/OpenSTA-8A0D3


[11/03/2025 20:35] mole99
This is the ‚ú® magic ‚ú® line for the `gf180mcu_fd_ip_sram__sram512x8m8wm1` SRAM:

```
add_pdn_stripe -grid macro -layer Metal4 -width 2.36 -offset 1.18 -spacing 0.28 -pitch 426.86 -starts_with GROUND -number_of_straps 2
```

It adds a power/ground pair on each side of the SRAM macro, directly above the pins. Since this uses the local coordinate system of the macro, you can move the macro around as you wish, the PDN straps will follow. As the PDN straps go all the way across the macro, connecting them to the PDN above is very easy.

{Reactions}
‚ú® üíØ

[11/03/2025 20:35] mole99
(top left)

{Attachments}
project-template_media/Bildschirmfoto_vom_2025-11-03_21-13-08-89A4F.png


[11/03/2025 20:35] mole99
(top right)

{Attachments}
project-template_media/Bildschirmfoto_vom_2025-11-03_21-13-33-4F47A.png


[11/03/2025 20:35] mole99
If you rotate the SRAM by 90 or 270 degrees, you need to use this line:

```
add_pdn_stripe -grid sram_macros_WE -layer Metal4 -width 2.36 -offset 1.18 -spacing 0.28 -pitch 479.88 -starts_with GROUND -number_of_straps 2
```

Unfortunately, the connection to VSS is not as good on the right side. It is better to use the first orientation.

Don't forget the PDN connect:

```
add_pdn_connect \
    -grid macro \
    -layers "$::env(PDN_VERTICAL_LAYER) Metal3"
```


[11/03/2025 20:35] mole99


{Attachments}
project-template_media/Bildschirmfoto_vom_2025-11-03_21-30-41-0737D.png


[11/03/2025 20:35] mole99
Now I just need to make magic DRC happy, and then I can push the the example usage of the SRAM to the template repo.


[11/03/2025 20:36] tholin
Awesome


[11/03/2025 20:36] tholin
I re-used my setup from GFMPW with a wrapper macro for the SRAM that just added the Metal4 strips.


[11/03/2025 20:36] tholin
Which is not optimal


[11/03/2025 20:37] mole99
Well, if I remember correctly, Efabless used your solution too :)


[11/03/2025 20:37] tholin
Yeah. That‚Äôs where I got it from.

{Reactions}
üëç

[11/03/2025 20:45] mole99
Started a thread.


[11/05/2025 05:53] greg.hashtag.9468
I've setup a new system following the readme. And then just run the stock template as a sanity check, it does complete. But I'm seeing KLayout DRC errors. (along with timing/cap/slew warnings at some corners)
```
...
    "DM4.8": 0,
    "DF.12": 3,
    "NW.2b_MV": 16,
    "DPF.4": 38,
    "DCF.4": 48,
    "total": 105
}
```
Is this expected? Or does it indicate something I should debug with my environment first?


[11/05/2025 07:38] mole99
Started a thread.


[11/06/2025 10:32] mole99 (pinned)
üì¢ It's update time!

The project template has been updated with support for the foundry SRAMs!
Two SRAMs of type `sram512x8m8wm1` are instantiated in `chip_core` and placed inside the chip in two different orientations (north and east).
If you add more SRAMs, make sure to update the LibreLane config (`librelane/config.yaml`) and the PDN configuration (`librelane/pdn_cfg.tcl`).

In addition, an issue has been fixed with filler generation, the way how the KLayout DRC deck was invoked (connectivity rules), and an error in the seal ring generator. With these changes the template is now DRC clean for both the magic and KLayout DRC deck.
Furthermore, the design is LVS clean and the there are no setup and hold violations for this example.

Please update your projects to the latest template, and don't forget to update the PDK as well (`make clone-pdk`).
Let me know if you have any questions.

{Reactions}
waferspace (5) üëç (2) üéâ

[11/06/2025 22:46] tholin
Updated my AS2650v2 wafer.space port to use the new method for instantiating SRAMs.

{Reactions}
üíú

[11/06/2025 22:46] tholin
Works!


[11/07/2025 05:46] mole99
Great to hear üëèüèª


[11/07/2025 12:03] mithro_
Pinned a message.


[11/07/2025 12:04] mithro_
@mole99 - Has performance / RAM usage changed much in the latest updates?


[11/07/2025 12:26] mole99
RAM usage has gone down drastically during the filler generation step after I fixed a bug there. However, that was already before this update.


[11/17/2025 10:35] 246tnt
How long does the template build (default) take for people ?


[11/17/2025 10:35] 246tnt
Just wondering if my vm is slow or something ...


[11/17/2025 10:39] mole99
The CI takes around 50mins without DRC: https://github.com/wafer-space/gf180mcu-project-template/actions/runs/19297076321/job/55181634117
Locally, it's faster for me. The DRC can then take an additional 1‚Äì1.5 hours.

{Reactions}
üëç

[11/17/2025 13:35] 246tnt
Here full run took 3h30 üòÖ 
Looking at timestamps, klayout drc was 2h 48 min of that.


[11/17/2025 13:36] tholin
What? My top-level DRC runs don't take nearly as long.


[11/17/2025 13:37] tholin
I'm also still struggling with analog pads not getting wired up.


[11/17/2025 14:18] mole99
Just had a full run (inlcuding DRC) in 48:05 using the template üòÅ


[11/17/2025 14:21] 246tnt
Huh ... that's worrying ...


[11/17/2025 17:57] tholin
Something changed. KLayout DRC is so much slower now.


[11/17/2025 18:52] mole99
There haven't been changes to the PDK for two weeks: https://github.com/wafer-space/gf180mcu
Although a number of changes are coming up.

{Embed}
https://github.com/wafer-space/gf180mcu
GitHub - wafer-space/gf180mcu: Temporary development repository for...
Temporary development repository for the gf180mcuD PDK variant. - wafer-space/gf180mcu
project-template_media/gf180mcu-6FE46


[11/17/2025 21:17] tholin
And why are my analog signals not getting routed?

{Attachments}
project-template_media/image-C20A2.png


[11/17/2025 21:31] tholin
I CTRL+F‚Äôd for "analog" in the global routing logs and found nothing. Its skipping it.


[11/17/2025 21:33] 246tnt
Are they defined any differently in your netlist ?


[11/17/2025 21:35] tholin
No


[11/18/2025 11:26] rzioma
Z80 design is finally green on github \o/
@mole99 is there a way to download artifacts / GDS from github job for local inspection? *I feel quite dumb for asking, but I couldn't figure how to do it so far*

{Attachments}
project-template_media/image-95F6F.png

{Reactions}
üéâ

[11/18/2025 11:30] rzioma
Ah, when building locally on Mac it is necessary to increase file-descriptor count otherwise Magic streamout fails `ulimit -n 1024`


[11/18/2025 11:32] rzioma
@mole99 I tried to add `ulimit` to flake.nix as shell hook, but failing so far even with ChatGPT *"help"* üòì


[11/18/2025 11:43] mole99
Hi ReJ! Congrats üëè
Just so you know, the CI only runs the implementation, as the DRC requires too much memory. So you need to make sure to run DRC locally.

Yes, there are ways to upload artifacts: https://docs.github.com/en/actions/tutorials/store-and-share-data
I haven't added this to the CI yet since I though it would quicky fill up the available storage space. But perhaps with a compression of the artifacts and a short retention time, it could be fine?

{Reactions}
‚ù§Ô∏è

[11/18/2025 11:45] rzioma
For some reason I get hold violations when I build locally (MacOS could be a problem here üòâ ), but it is fine building on github. Investigating atm.


==============================================================
Exported 112 message(s)
==============================================================
